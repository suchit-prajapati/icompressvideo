<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>iCompressVideo</title>
  <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
  <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  <link href="./output.css" rel="stylesheet">
</head>
<body>
  <div id="root"></div>
  <script type="text/babel">
    const { useState, useEffect } = React;

    function App() {
      const [file, setFile] = useState(null);
      const [isDragging, setIsDragging] = useState(false);
      const [progress, setProgress] = useState(0);
      const [template, setTemplate] = useState('default');
      const [largeText, setLargeText] = useState(false);
      const [error, setError] = useState('');

      const speak = (text) => {
        setTimeout(() => {
          const utterance = new SpeechSynthesisUtterance(text);
          utterance.lang = 'en-US';
          window.speechSynthesis.speak(utterance);
        }, 500);
      };

      const handleDrop = (e) => {
        e.preventDefault();
        setIsDragging(false);
        setError('');
        const droppedFile = e.dataTransfer.files[0];
        if (droppedFile) {
          if (droppedFile.type.startsWith('video/')) {
            if (droppedFile.size <= 500 * 1024 * 1024) {
              setFile(droppedFile);
              speak('Video uploaded successfully');
            } else {
              setError('File size exceeds 500MB limit');
              speak('File size exceeds 500MB limit');
            }
          } else {
            setError('Please upload a valid video file (MP4, AVI, MOV)');
            speak('Please upload a valid video file');
          }
        }
      };

      const handleFileChange = (e) => {
        setError('');
        const selectedFile = e.target.files[0];
        if (selectedFile) {
          if (selectedFile.type.startsWith('video/')) {
            if (selectedFile.size <= 500 * 1024 * 1024) { // Fixed: changed droppedFile to selectedFile
              setFile(selectedFile);
              speak('Video uploaded successfully');
            } else {
              setError('File size exceeds 500MB limit');
              speak('File size exceeds 500MB limit');
            }
          } else {
            setError('Please upload a valid video file (MP4, AVI, MOV)');
            speak('Please upload a valid video file');
          }
        }
      };

      useEffect(() => {
        if (file && progress > 0 && progress < 100) {
          const timer = setInterval(() => {
            setProgress((prev) => {
              if (prev >= 100) {
                clearInterval(timer);
                speak('Processing complete');
                return 100;
              }
              return prev + 10;
            });
          }, 500);
          return () => clearInterval(timer);
        }
      }, [file, progress]);

      useEffect(() => {
        if (!file) {
          setProgress(0);
          setError('');
        }
      }, [file]);

      const handleDragOver = (e) => {
        e.preventDefault();
        setIsDragging(true);
      };

      const handleDragLeave = () => setIsDragging(false);

      const templateStyles = {
        default: 'border-gray-300 bg-white',
        school: 'border-blue-300 bg-blue-50',
        birthday: 'border-pink-300 bg-pink-50'
      };

      return (
        <div
          className={`p-6 max-w-2xl mx-auto min-h-screen flex flex-col items-center ${
            largeText ? 'text-2xl' : 'text-base'
          } ${templateStyles[template]}`}
        >
          <h1 className="text-4xl font-bold mb-6 text-center text-gray-800">
            iCompressVideo
          </h1>

          <div
            className={`border-4 border-dashed p-8 mb-6 rounded-lg text-center w-full max-w-md transition-colors duration-300 ${
              isDragging ? 'border-blue-500 bg-blue-100' : 'border-gray-400'
            }`}
            onDrop={handleDrop}
            onDragOver={handleDragOver}
            onDragLeave={handleDragLeave}
          >
            <p className="mb-4 text-gray-600 font-medium">
              {isDragging ? 'Drop your video here' : 'Drag & drop your video here'}
            </p>
            <label className="cursor-pointer inline-block">
              <input
                type="file"
                accept="video/mp4,video/avi,video/mov"
                onChange={handleFileChange}
                className="hidden"
              />
              <span className="bg-gray-200 text-gray-700 px-4 py-2 rounded-lg hover:bg-gray-300 transition-colors">
                Choose File
              </span>
            </label>
            <p className="mt-2 text-gray-500">{file ? file.name : 'No file chosen'}</p>
          </div>

          {error && (
            <p className="text-red-500 mb-6 font-medium">{error}</p>
          )}

          {file && !error && (
            <p className="mb-6 text-gray-700">
              Selected: {file.name} ({(file.size / (1024 * 1024)).toFixed(2)} MB)
            </p>
          )}

          <div className="mb-6 w-full max-w-md">
            <label className="block mb-2 font-semibold text-gray-800">Choose Template:</label>
            <select
              className="border-2 border-gray-300 p-2 rounded-lg w-full bg-white focus:outline-none focus:border-blue-500 transition-colors"
              value={template}
              onChange={(e) => {
                setTemplate(e.target.value);
                speak(`Selected ${e.target.value} template`);
              }}
            >
              <option value="default">Default</option>
              <option value="school">School Project</option>
              <option value="birthday">Birthday Video</option>
            </select>
          </div>

          <div className="flex gap-4 mb-6 justify-center">
            <button
              className="bg-blue-500 text-white px-6 py-3 rounded-lg hover:bg-blue-600 disabled:bg-gray-400 transition-colors font-semibold"
              onClick={() => {
                if (file) {
                  setProgress(10);
                  speak('Starting compression');
                } else {
                  speak('Please upload a video first');
                }
              }}
              disabled={!!error}
            >
              Compress
            </button>
            <button
              className="bg-green-500 text-white px-6 py-3 rounded-lg hover:bg-green-600 disabled:bg-gray-400 transition-colors font-semibold"
              onClick={() => {
                if (file) {
                  setProgress(10);
                  speak('Starting conversion');
                } else {
                  speak('Please upload a video first');
                }
              }}
              disabled={!!error}
            >
              Convert
            </button>
            <button
              className="bg-purple-500 text-white px-6 py-3 rounded-lg hover:bg-purple-600 disabled:bg-gray-400 transition-colors font-semibold" // Fixed: corrected hover:bg-blue-600 to hover:bg-purple-600
              onClick={() => {
                if (file) {
                  setProgress(10);
                  speak('Starting trimming');
                } else {
                  speak('Please upload a video first');
                }
              }}
              disabled={!!error}
            >
              Trim
            </button>
          </div>

          {progress > 0 && (
            <div className="w-full max-w-md bg-gray-200 rounded-full h-4 mb-6">
              <div
                className="bg-blue-500 h-4 rounded-full transition-all duration-500"
                style={{ width: `${progress}%` }}
              ></div>
            </div>
          )}

          <div className="text-center">
            <button
              className="bg-gray-500 text-white px-6 py-3 rounded-lg hover:bg-gray-600 transition-colors font-semibold"
              onClick={() => {
                setLargeText(!largeText);
                speak(largeText ? 'Normal text enabled' : 'Large text enabled');
              }}
            >
              {largeText ? 'Normal Text' : 'Large Text'}
            </button>
          </div>
        </div>
      );
    }

    ReactDOM.render(<App />, document.getElementById('root'));
  </script>
</body>
</html>